"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(){function t(t){var e=document.getElementById("Hbirth"),a=this;this.dpr=document.documentElement.getAttribute("data-dpr")||1,this.main=e,this.container=e.getElementsByClassName("Hbirth-container")[0],this.cancelBt=e.getElementsByClassName("Hbirth-cancel")[0],this.confirmBt=e.getElementsByClassName("Hbirth-confirm")[0],this.yearDom=e.getElementsByClassName("Hbirth-year")[0],this.monthDom=e.getElementsByClassName("Hbirth-month")[0],this.dateDom=e.getElementsByClassName("Hbirth-date")[0],this.yearList="",this.monthList="",this.dateList="",this.oldY=0,this.isIphone=/iP(ad|hone|od)/.test(navigator.userAgent)&&/iP(ad|hone|od)/.test(navigator.platform),this.now=new Date,this.nowYear=this.now.getFullYear(),this.nowMonth=this.now.getMonth(),this.noeDate=this.now.getDate(),t&&(this.startYear=t.startYear||1970,this.endYear=t.endYear||this.nowYear,this.endMonth=t.endMonth||this.nowMonth,this.callback=t.callback||null),"0"===e.getAttribute("data-status")&&this.creatDate(),this.startAnim(),this.cancelBt.addEventListener("click",function(){a.close()}),this.confirmBt.addEventListener("click",function(){a.close();var t=a.yearDom.getElementsByClassName("highlight")[0].getAttribute("data-value"),e=a.monthDom.getElementsByClassName("highlight")[0].getAttribute("data-value"),i=a.dateDom.getElementsByClassName("highlight")[0].getAttribute("data-value"),s=[t,e,i];a.callback(s)}),e.addEventListener("click",function(t){t.target.classList.contains("Hbirth")&&a.close()}),e.addEventListener("touchmove",function(t){t.preventDefault()})}t.prototype.startAnim=function(){var t=this;t.main.style.display="block",setTimeout(function(){t.container.classList.add("Hbirth-container-show")})},t.prototype.creatDate=function(){for(var t=this,e=t.startYear,a=t.endYear,i=t.yearDom,s=t.monthDom,n={},r=[],o=e;o<=a;o++)n={},n.text=o+"年",n.id=o,r.push(n);t.creatList(i,r),r=[];for(var o=1;o<=12;o++)n={},n.text=o+"月",n.id=o,r.push(n);t.creatList(s,r),t.getDateList(t.startYear,1),t.main.setAttribute("data-status",1)},t.prototype.getDateList=function(t,e){for(var a=this,i=a.dateDom,s=(a.dpr,new Date(t,e,0)),n=s.getDate(),r={},o=[],l=1;l<=n;l++)r={},r.text=l+"日",r.id=l,o.push(r);a.creatList(i,o),i.style.transform="perspective(1000px) rotateX(0deg)",i.style.webkitTransform="perspective(1000px) rotateX(0deg)"},t.prototype.creatList=function(t,e){var a=this,i="",s=e.length,n=90*a.dpr,r="transform-origin: center center -"+n+"px;-webkit-transform-origin: center center -"+n+"px;";if(a.isIphone)for(var o=0;o<s;o++)i+='<li style="'+r+"transform: translateZ(0) rotateX(-"+20*o+"deg);-webkit-transform: translateZ(0) rotateX(-"+20*o+'deg);" data-value="'+e[o].id+'">'+e[o].text+"</li>";else for(var o=0;o<s;o++)i+='<li style="'+r+"transform: translateZ("+n+"px) rotateX(-"+20*o+"deg);-webkit-transform: translateZ("+n+"px) rotateX(-"+20*o+'deg);" data-value="'+e[o].id+'">'+e[o].text+"</li>";t.innerHTML="",t.insertAdjacentHTML("afterbegin",i);var e=t.getElementsByTagName("li");a.draw(e),a.addEvent(t.parentElement)},t.prototype.draw=function(t,e){e=e||0;for(var a=t.length,i=e,s=e+4,n=e-4,r=0;r<a;r++)t[r].classList.remove("visible"),t[r].classList.remove("highlight");if(e>=a)return t[a-1].classList.add("highlight"),void t[a-1].classList.add("visible");if(a<0)return t[0].classList.add("highlight"),void t[0].classList.add("visible");for(t[e].classList.add("highlight"),t[i].classList.add("visible");i<s&&!(++i>a-1);)t[i].classList.add("visible");for(i=e;i>n&&!(--i<0);)t[i].classList.add("visible")},t.prototype.addEvent=function(t){var e=this,a=t.getElementsByTagName("ul")[0],i="picker-y"===t.getAttribute("data-id"),s="picker-m"===t.getAttribute("data-id"),n=a.getElementsByTagName("li"),r=n.length,o=20*(r-1),l=0,c=0;t.addEventListener("touchstart",function(t){t.preventDefault();var e=t.touches[0]||t.changedTouches[0];l=e.clientY}),t.addEventListener("touchmove",function(t){t.preventDefault();var i=(t.target,t.touches[0]||t.changedTouches[0]),s=i.clientY,r=0;(c=e.oldY+(l-s))<=0||c>=o||(r=Math.round(c/20),a.style.transform="perspective(1000px) rotateX("+c+"deg)",a.style.webkitTransform="perspective(1000px) rotateX("+c+"deg)",e.draw(n,r))}),t.addEventListener("touchend",function(t){t.preventDefault();var d=(t.target,t.touches[0]||t.changedTouches[0]),h=d.clientY,m=0,u=0;c=e.oldY+(l-h),m=Math.round(c/20),c<=0?(u=0,m=0):c>=o?(u=o,m=r-1):u=20*m,a.style.transition="transform .1s ease",a.style.webkitTransition="transform .1s ease",a.style.transform="perspective(1000px) rotateX("+u+"deg)",a.style.webkitTransform="perspective(1000px) rotateX("+u+"deg)",e.oldY=u,e.draw(n,m),(i||s)&&e.getDateList(e.getActive(e.yearDom),e.getActive(e.monthDom))})},t.prototype.close=function(){var t=this;t.main.style.display="none",t.container.classList.remove("Hbirth-container-show")},t.prototype.closest=function(t,e){if("."==e[0])for(e=e.substring(1);t;){if(t.classList.contains(e))return t;t=t.parentElement}return null},t.prototype.getActive=function(t){return t.getElementsByClassName("highlight")[0].getAttribute("data-value")},t.init=function(e){return new t(e)},"function"==typeof define&&"object"===_typeof(define.amd)&&define.amd?define(function(){return t}):"undefined"!=typeof module&&module.exports?module.exports=t.init():window.HDate=t}();